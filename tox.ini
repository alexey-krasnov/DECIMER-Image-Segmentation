[tox]
envlist = py310, lint
requires = tox-conda

[testenv]
setenv =
    CONDA_DLL_SEARCH_MODIFICATION_ENABLE = 1
whitelist_externals = python
conda_deps =
    pytest
conda_channels =
    conda-forge
commands = pytest --basetemp="{envtmpdir}" {posargs}

[pytest]
filterwarnings =
    ignore:builtin type Swig.*:DeprecationWarning
    ignore:builtin type swigvarlink.*:DeprecationWarning
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    requires_model: marks tests that require model weights
    benchmark: marks benchmark tests

[testenv:lint]
basepython = python3
skip_install = true
conda_deps = flake8
commands = flake8 .

[flake8]
ignore = E226, E302, E41, E501, W504, F821, E203, W605, W503, F401, E402
exclude =
    __pycache__,
    .git,
    .eggs,
    .github,
    .tox,
    docs/conf.py,
    build,
    dist,
    *.pyc,
    *.egg-info,
    .cache,
    CITATION.cff,
    setup.py,
    tests/test_mask_expansion.py,
    decimer_segmentation/__init__.py,
    decimer_segmentation/mrcnn/moldetect.py,
